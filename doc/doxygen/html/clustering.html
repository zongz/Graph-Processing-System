<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9"/>
<title>GraphLab: Distributed Graph-Parallel API: Clustering</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">GraphLab: Distributed Graph-Parallel API
   &#160;<span id="projectnumber">2.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('clustering.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Clustering </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This toolkit will contain implementations of clustering algorithm.</p>
<p>Currently the algorithms implemented are</p>
<ul>
<li><a class="el" href="clustering.html#clustering_kmeans">KMeans++</a> </li>
<li><a class="el" href="clustering.html#clustering_spectral_clustering">Spectral Clustering</a></li>
</ul>
<h1><a class="anchor" id="clustering_kmeans"></a>
KMeans++</h1>
<p>The <code>kmeans</code> program implements the <a href="http://en.wikipedia.org/wiki/K-means%2B%2B">KMeans++</a> algorithm described by</p>
<p>Arthur, D. and Vassilvitskii, S. (2007). "k-means++: the advantages of careful seeding". Proceedings of the eighteenth annual ACM-SIAM symposium on Discrete algorithms. pp. 1027â€“1035.</p>
<p>It takes as input a collection of files where each line in each file represents a data point. Each line must contains a list of numbers, white-space or comma separated. Each line must be the same length.</p>
<p>For instance in this example input file, there are 6 datapoints, one per line, and each datapoint is a point in a 5-dimensional space.</p>
<pre class="fragment">-10.7551  6.82178 5.33455 -2.08247  2.86694 
-1.36687  10.8464 -5.28851  -4.26768  -5.50659  
-8.79834  8.01002 5.33418 0.102824  3.23318 
-8.64345  6.81946 1.2309  -4.46784  2.26341 
-8.29782  7.1154  3.32559 -2.59422  2.33936 
-8.12504  8.98924 4.15027 0.253153  1.75911 
</pre><h2><a class="anchor" id="clustering_kmeans_synthetic"></a>
Synthetic Data</h2>
<p>Example synthetic data can be generated by running</p>
<pre class="fragment">&gt; ./generate_synthetic [Number of Clusters] [Number of Dimensions] [Number of datapoints]
</pre><p>This will generate a file called <code>synthetic.txt</code> , and will also output to screen the cluster centers.</p>
<p>For instance: </p><pre class="fragment">&gt; ./generate_synthetic 2 3 10
Usage: generate_synthetic [NClusters] [Dimensions] [Ndata]
Center 0 at: -6.69675 0.355189  -4.88601  
Center 1 at: 5.85919  0.0388327 5.50007  

&gt; cat synthetic.txt
-4.31568  -0.396959 -6.29507  
-4.56112  -1.74917  -4.57874  
4.54508 0.102845  6.35385 
4.87746 -0.832591 7.06942 
-5.91254  -0.278006 -4.25934  
6.95139 0.120139  4.89531 
-6.28538  -0.88527  -4.74988  
-6.84791  0.887664  -4.91919  
7.47117 1.67911 6.02221 
-4.78011  1.2099  -4.55519  
</pre><dl class="section note"><dt>Note</dt><dd>Mathematically, the synthetic generator draws centers from the [-10,10]^D uniform hypercube and draws data points by sampling uniformly from the centers, and around a unit gaussian around each center.</dd></dl>
<h2><a class="anchor" id="clustering_kmeans_running"></a>
Running KMeans</h2>
<p>To run Kmeans clustering: </p><pre class="fragment">&gt; ./kmeans --data=[data prefix] --cluster=[N cluster] --output-clusters=[cluster output file]
</pre><p>All files beginning with the data prefix will be loaded. The data may be on HDFS. The <code>&ndash;cluster</code> option is the number of clusters to solve for.</p>
<p>The cluster output file must be a target accessible on the local file system. (In the distributed case, it must be accessible from the 0th machine). This file will contain a list of all the solved cluster centers.</p>
<p>For instance, running on the synthetic data above: </p><pre class="fragment">&gt;./kmeans --data=synthetic.txt --clusters=2 --output-clusters=cluster.txt
Number of datapoints: 10
Validating data...Initializing using Kmeans++
Running Kmeans...
Kmeans iteration 1: # points with changed assignments = 0
Writing Cluster Centers...

&gt;cat cluster.txt
-5.45046  -0.201973 -4.8929 
5.96127 0.267376  6.0852  
</pre><p>To also output the cluster center assignments for each datapoint, add the option: </p><pre class="fragment">--output-data=[output prefix]
</pre><p>Tne <code>output prefix</code> is where the output data will be written. This may be located on HDFS. For instance, if the <code>output_prefix</code> is <code>"v_out"</code>, the output files will be written to:</p>
<pre class="fragment">v_out_1_of_16
v_out_2_of_16
...
v_out_16_of_16
</pre><p>Each line in the output files contain firstly, the original data point, followed $by the cluster number it was assigned to. These need not be in the same order as the original input.</p>
<p>For instance, running kmeans on the example synthetic data above may produce the following output:</p>
<pre class="fragment">&gt;./kmeans --data=synthetic.txt --clusters=2 --output-clusters=cluster.txt --output-data=data.txt
Number of datapoints: 10
Validating data...Initializing using Kmeans++
Running Kmeans...
Kmeans iteration 1: # points with changed assignments = 0
Writing Cluster Centers...
Writing Data with cluster assignments...

&gt;cat data.txt
-4.78011  1.2099  -4.55519  0
7.47117 1.67911 6.02221 1
-6.84791  0.887664  -4.91919  0
-6.28538  -0.88527  -4.74988  0
6.95139 0.120139  4.89531 1
-5.91254  -0.278006 -4.25934  0
4.87746 -0.832591 7.06942 1
4.54508 0.102845  6.35385 1
-4.56112  -1.74917  -4.57874  0
-4.31568  -0.396959 -6.29507  0
</pre><p>This program can also run distributed by using </p><pre class="fragment">&gt; mpiexec -n [N machines] --hostfile [host file] ./kmeans ....
</pre><p> See your MPI documentation for details on how to launch this job. All machines must have access to the input graph location and the output graph location. Graphs may be on HDFS. If you have problems loading HDFS files, see the <a class="el" href="FAQ.html">FAQ</a>.</p>
<h2><a class="anchor" id="clustering_kmeans_sparse"></a>
--sparse Option</h2>
<p>If <code>&ndash;sparse=1</code> is set (default is 0), the program will use a sparse vector representation. The file format is [feature id]:[value] [feature id]:[value] ... Each line corresponds to a datapoint. [feature id] must be positive integer or zero.</p>
<p>For instance: </p><pre class="fragment">&gt; cat synthetic_sparse.txt
0:-4.31568  3:-0.396959 5:-6.29507  
5:-4.56112  9:-1.74917  
4:4.54508 5:0.102845  10:6.35385 
0:4.87746 7:-0.832591 
</pre><h2><a class="anchor" id="clustering_kmeans_id"></a>
--id Option</h2>
<p>If <code>&ndash;id=1</code> is set (default is 0), the program will use id for each data point. The id of a data point must be written at the head of each line of the input data.</p>
<p>For instance: </p><pre class="fragment">&gt; cat synthetic_with_id.txt
1 -4.31568  -0.396959 -6.29507  
2 -4.56112  -1.74917  -4.57874  
3 4.54508 0.102845  6.35385 
4 4.87746 -0.832591 7.06942 
</pre><p>The output data will consist of two columns: one for the ids and the other for the assigned clusters.</p>
<p>For instance: </p><pre class="fragment">&gt; cat data_with_id.txt
1 0
2 0  
3 1
4 1 
</pre><p><code>&ndash;id</code> can be used with <code>&ndash;sparse</code>.</p>
<h2><a class="anchor" id="clustering_kmeans_edge_data"></a>
Adding Pairwise Reward</h2>
<p>This program can consider pairwise rewards (and penalty) by using <code>&ndash;pairwise-reward=[file prefix]</code>. All files beginning with <code>[file prefix]</code> will be loaded for pairwise rewards. Each line of the pairwise reward file holds [id1] [id2] [weight]. This option must be used with <code>&ndash;id=1</code>.</p>
<p>For instance: </p><pre class="fragment">&gt; cat pairwise_data.txt
1 2 10
2 4 -10
</pre><p>In this example the evaluation function will gain 10 when data <code>1</code> and data <code>2</code> are in the same cluster; it will gain nothing otherwise.</p>
<h2><a class="anchor" id="clustering_kmeans_options"></a>
Options</h2>
<ul>
<li><b>&ndash;data</b> (Required). The prefix from which to load the input data </li>
<li><b>&ndash;clusters</b> (Required). The number of cluster centers </li>
<li><b>&ndash;ncpus</b> (Optional. Default 2) The number of processors that will be used for computation. <b>Due to some implementation limitations within GraphLab, this parameter is not respected. It will use all processors on your machine if ran in Linux, and will use only 1 processor if ran on Mac</b> </li>
<li><b>&ndash;output-data</b> (Optional) A target prefix to write the output data with cluster assignments. May be on HDFS. </li>
<li><b>&ndash;output-clusters</b> (Optional) A target location to write the cluster centers. Must be on the local file system. </li>
<li><b>&ndash;sparse</b> (Optional. Default 0) If set at 1, will use sparse vector representation </li>
<li><b>&ndash;id</b> (Optional. Default 0) If set at 1, will use ids for data points </li>
<li><b>&ndash;pairwise-reward</b> (Optional) If set, will consider pairwise rewards written in the files beginning with the given argument </li>
<li><b>&ndash;max-iteration</b> (Optional) The max number of iterations</li>
</ul>
<h1><a class="anchor" id="clustering_spectral_clustering"></a>
Spectral Clustering</h1>
<p>This program takes as input a collection of files where each line in each file represents a data point. Each line must contains an id and a list of numbers, white-space or comma separated. Each line must be the same length. For instance in this example input file, there are 6 datapoints, one per line, and each datapoint is a point in a 5-dimensional space.</p>
<pre class="fragment">1 -10.7551  6.82178 5.33455 -2.08247  2.86694
2 -1.36687  10.8464 -5.28851  -4.26768  -5.50659
3 -8.79834  8.01002 5.33418 0.102824  3.23318 
4 -8.64345  6.81946 1.2309  -4.46784  2.26341 
5 -8.29782  7.1154  3.32559 -2.59422  2.33936
6 -8.12504  8.98924 4.15027 0.253153  1.75911 
</pre><p>The ids of data points must start from 1 and must not skip any numbers.</p>
<p>To run spectral clustering, the minimal set of options required are:</p>
<pre class="fragment">&gt; ./spectral_clustering --data=[data prefix] --clusters=[N cluster]
</pre><p>This program uses svd in Graphlab Collaborative Filtering Toolkit, kmeans in Graphlab Clustering Toolkit and eigen_vector_normalization in Graphlab Graph Analytics Toolkit. The paths to the directories are specified by <code>&ndash;svd-dir</code>, <code>&ndash;kmeans-dir</code> and <code>&ndash;graph-analytics-dir</code>, respectively.</p>
<p>The program will create some intermediate files. The final clustering result is written in files named <code>[data prefix].result</code> with a suffix, for example <code>[data prefix].result_1_of_4</code>. The clustering result data will consist of two columns: one for the ids and the other for the assigned clusters. For instance:</p>
<pre class="fragment">1 1
2 0
3 1
4 1
5 1
</pre><p><b>NOTE:</b> To run the spectral clustering in a distributed setting, you must use the "mpi-args" option, not like other graphlab toolkits. The spectral clustering calls other graphlab programs. When "--mpi-args" is set, these graphlab programs are called with "mpiexec" and the string written after the "mpi-args" option. For example, if you set &ndash;mpi-args="-n 4 --hostfile host", the program calls the other graphlab programs with "mpiexec -n 4 --hostfile host".</p>
<h2><a class="anchor" id="Options"></a>
Options</h2>
<p>Relevant options are: </p><ul>
<li><b>&ndash;data</b> (Required). The prefix from which to load the input data </li>
<li><b>&ndash;clusters</b> (Required). The number of clusters </li>
<li><b>&ndash;sigma</b> (Optional. Default 0.1). Scale parameter for Gaussian kernel. This value is often critical to the clustering result. </li>
<li><b>&ndash;t-nearest</b> (Optional. Default 20). Number of nearest neighbors (=t). Will use only the t-nearest similarities for each datapoint. If set at 0, will use all similarities. </li>
<li><b>&ndash;similarity-thres</b> (Optional). Threshold to discard small similarities. If a value is set, similarities less than this value will be discarded. </li>
<li><b>&ndash;svd-dir</b> (Optional Default ../collaborative_filtering/). Path to the directory where Graphlab svd is located </li>
<li><b>&ndash;kmeans-dir</b> (Optional. Default ../clustering/). Path to the directory where Graphlab kmeans is located </li>
<li><b>&ndash;graph-analytics-dir</b> (Optional. Default ../graph_analytics/). Path to the directory where Graphlab eigen_vector_normalization is located </li>
<li><b>&ndash;ncpus</b> (Optional. Default 2). The number of processors that will be used for computation. <b>Due to some implementation limitations within GraphLab, this parameter is not respected. It will use all processors on your machine if ran in Linux, and will use only 1 processor if ran on Mac</b> </li>
<li><b>&ndash;graph_opts</b> (Optional, Default empty). Any additional graph options. See <a class="el" href="classgraphlab_1_1distributed__graph.html" title="A directed graph datastructure which is distributed across multiple machines. ">graphlab::distributed_graph</a> a list of options. </li>
<li><b>&ndash;mpi-args</b> (Optional, Default empty). If set, will execute mipexec with the given string. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="toolkits.html">GraphLab Toolkits</a></li>
    <li class="footer">Generated on Mon Dec 29 2014 17:16:26 for GraphLab: Distributed Graph-Parallel API by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9 </li>
  </ul>
</div>
</body>
</html>
