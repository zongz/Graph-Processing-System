<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9"/>
<title>GraphLab: Distributed Graph-Parallel API: graphlab::zookeeper::key_value Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">GraphLab: Distributed Graph-Parallel API
   &#160;<span id="projectnumber">2.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classgraphlab_1_1zookeeper_1_1key__value.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classgraphlab_1_1zookeeper_1_1key__value-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">graphlab::zookeeper::key_value Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="key__value_8hpp_source.html">graphlab/zookeeper/key_value.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:aa6c569c68715ad1eb93159b61f3d7138"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa6c569c68715ad1eb93159b61f3d7138"></a>
typedef boost::function&lt; void(<a class="el" href="classgraphlab_1_1zookeeper_1_1key__value.html">key_value</a> *, const std::vector&lt; std::string &gt; &amp;out_newkeys, const std::vector&lt; std::string &gt; &amp;out_deletedkeys, const std::vector&lt; std::string &gt; &amp;out_modifiedkeys) &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>callback_type</b></td></tr>
<tr class="separator:aa6c569c68715ad1eb93159b61f3d7138"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae1a4a45f839a27467f58963f69c485cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraphlab_1_1zookeeper_1_1key__value.html#ae1a4a45f839a27467f58963f69c485cc">key_value</a> (std::vector&lt; std::string &gt; zkhosts, std::string prefix, std::string serveridentifier)</td></tr>
<tr class="separator:ae1a4a45f839a27467f58963f69c485cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a727bdf5c0ba38f61e199d91ec6c14284"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a727bdf5c0ba38f61e199d91ec6c14284"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraphlab_1_1zookeeper_1_1key__value.html#a727bdf5c0ba38f61e199d91ec6c14284">~key_value</a> ()</td></tr>
<tr class="memdesc:a727bdf5c0ba38f61e199d91ec6c14284"><td class="mdescLeft">&#160;</td><td class="mdescRight">destructor <br /></td></tr>
<tr class="separator:a727bdf5c0ba38f61e199d91ec6c14284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4da92ea30ed605445370475a2934ebfb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraphlab_1_1zookeeper_1_1key__value.html#a4da92ea30ed605445370475a2934ebfb">insert</a> (const std::string &amp;key, const std::string &amp;value)</td></tr>
<tr class="separator:a4da92ea30ed605445370475a2934ebfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd2871db94793b8e1a3659d70934b05"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraphlab_1_1zookeeper_1_1key__value.html#a0bd2871db94793b8e1a3659d70934b05">modify</a> (const std::string &amp;key, const std::string &amp;value)</td></tr>
<tr class="separator:a0bd2871db94793b8e1a3659d70934b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3b53bd9ce11cf777d7167fa95160912"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraphlab_1_1zookeeper_1_1key__value.html#ad3b53bd9ce11cf777d7167fa95160912">erase</a> (const std::string &amp;key)</td></tr>
<tr class="separator:ad3b53bd9ce11cf777d7167fa95160912"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9093c2ee60a9579b2b16b1428896214"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af9093c2ee60a9579b2b16b1428896214"></a>
std::pair&lt; bool, std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraphlab_1_1zookeeper_1_1key__value.html#af9093c2ee60a9579b2b16b1428896214">get</a> (const std::string &amp;key)</td></tr>
<tr class="memdesc:af9093c2ee60a9579b2b16b1428896214"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value of a key. First element of the pair is if the key was found. <br /></td></tr>
<tr class="separator:af9093c2ee60a9579b2b16b1428896214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaff0dd6dc87e56fdf5b9b569a9016d10"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraphlab_1_1zookeeper_1_1key__value.html#aaff0dd6dc87e56fdf5b9b569a9016d10">add_callback</a> (callback_type fn)</td></tr>
<tr class="separator:aaff0dd6dc87e56fdf5b9b569a9016d10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88f847b0ff5f6626109d3fcaed096196"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraphlab_1_1zookeeper_1_1key__value.html#a88f847b0ff5f6626109d3fcaed096196">remove_callback</a> (int fnid)</td></tr>
<tr class="separator:a88f847b0ff5f6626109d3fcaed096196"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A simple zookeeper service to maintain a key value store The service provides the ability to watch for changes through the use of callbacks. Keys are "owned" by their creators, and duplicate keys are not permitted. Owners can change the values of their owned keys. Keys are destroyed when their owners die.</p>
<p>The natural implementation will be to create a node for each key and have the node contain the actual value of the key. However, it is very difficult to watch for changes here because if there are a large number of keys, we have to set a data watch on each key, and zookeeper does not like it if you make too many watches.</p>
<p>The solution: For each key</p><ul>
<li>An ephemeral masters/[key]" node is created. This is used to identify the machine currently owning the key, and make sure that there can only be one owner for each key.</li>
<li>A SEQUENCE EPHEMERAL node with the name "values/[key]-%10d" is created whenever the value of the key changes. The contents of the node are the contents of the key.</li>
<li>Now a single watch on the entire values directory is sufficient to identify any data changes. </li>
</ul>

<p>Definition at line <a class="el" href="key__value_8hpp_source.html#l00066">66</a> of file <a class="el" href="key__value_8hpp_source.html">key_value.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ae1a4a45f839a27467f58963f69c485cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">graphlab::zookeeper::key_value::key_value </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>zkhosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>serveridentifier</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Joins a zookeeper cluster. Zookeeper nodes will be created in the prefix "prefix". </p>

<p>Definition at line <a class="el" href="key__value_8cpp_source.html#l00042">42</a> of file <a class="el" href="key__value_8cpp_source.html">key_value.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aaff0dd6dc87e56fdf5b9b569a9016d10"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int graphlab::zookeeper::key_value::add_callback </td>
          <td>(</td>
          <td class="paramtype">callback_type&#160;</td>
          <td class="paramname"><em>fn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a callback which will be triggered when any key/value changes. The callback arguments will be the <a class="el" href="classgraphlab_1_1zookeeper_1_1key__value.html">key_value</a> object, and the new complete key-value mapping. Calling this function will a NULL argument deletes the callback. Note that the callback may be triggered in a different thread.</p>
<p>Returns the id of the callback. Calling remove_callback with the id disables the callback. </p>

<p>Definition at line <a class="el" href="key__value_8cpp_source.html#l00353">353</a> of file <a class="el" href="key__value_8cpp_source.html">key_value.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad3b53bd9ce11cf777d7167fa95160912"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool graphlab::zookeeper::key_value::erase </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removed a key in the key value store. Returns true on success. False on failure. This instance must own the key (created the key) to delete the key. </p>

<p>Definition at line <a class="el" href="key__value_8cpp_source.html#l00162">162</a> of file <a class="el" href="key__value_8cpp_source.html">key_value.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4da92ea30ed605445370475a2934ebfb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool graphlab::zookeeper::key_value::insert </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inserts a value to the key value store. Returns true on success. False on failure (indicating the key already exists) </p>

<p>Definition at line <a class="el" href="key__value_8cpp_source.html#l00118">118</a> of file <a class="el" href="key__value_8cpp_source.html">key_value.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0bd2871db94793b8e1a3659d70934b05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool graphlab::zookeeper::key_value::modify </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Modifies the value in the key value store. Returns true on success. False on failure. This instance must own the key (created the key) to modify its value. </p>

<p>Definition at line <a class="el" href="key__value_8cpp_source.html#l00135">135</a> of file <a class="el" href="key__value_8cpp_source.html">key_value.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a88f847b0ff5f6626109d3fcaed096196"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool graphlab::zookeeper::key_value::remove_callback </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fnid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes a callback identified by an ID. Returns true on success, false on failure </p>

<p>Definition at line <a class="el" href="key__value_8cpp_source.html#l00362">362</a> of file <a class="el" href="key__value_8cpp_source.html">key_value.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>graphlab/zookeeper/<a class="el" href="key__value_8hpp_source.html">key_value.hpp</a></li>
<li>graphlab/zookeeper/<a class="el" href="key__value_8cpp_source.html">key_value.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacegraphlab.html">graphlab</a></li><li class="navelem"><b>zookeeper</b></li><li class="navelem"><a class="el" href="classgraphlab_1_1zookeeper_1_1key__value.html">key_value</a></li>
    <li class="footer">Generated on Mon Dec 29 2014 17:16:28 for GraphLab: Distributed Graph-Parallel API by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9 </li>
  </ul>
</div>
</body>
</html>
